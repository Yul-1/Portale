# nginx/nginx-frontend.conf
# This configuration is for the Nginx server running inside the 'frontend' container,
# dedicated to serving the compiled React application.

server {
    listen 80; # Listen on port 80 inside the container
    server_name localhost; # Internal container name

    # Root directory for serving static files (React build output)
    root /usr/share/nginx/html;

    # Index file for directory requests
    index index.html index.htm;

    # Important: For React Router (Single Page Application - SPA)
    # Tries to serve the requested URI, if not found, falls back to index.html
    location / {
        try_files $uri $uri/ /index.html;
    }

    # Optional: Cache control for React assets (JS, CSS, images)
    # The main Nginx in docker-compose.prod.yml also handles caching,
    # but this ensures internal Nginx also sets headers.
    location ~* \.(css|js|gif|jpe?g|png|webp|svg|ico)$ {
        expires 1y; # Cache assets for 1 year
        add_header Cache-Control "public, immutable";
    }

    # Optional: Gzip compression for static assets
    # The main Nginx will handle external gzip, but this is for completeness.
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_min_length 1000;
}